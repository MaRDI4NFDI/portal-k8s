apiVersion: helm.toolkit.fluxcd.io/v2
kind: HelmRelease
metadata:
  name: matomo
spec:
  interval: 5m
  chartRef:
    kind: OCIRepository
    name: bitnami-matomo
    namespace: flux-system
  values:
    updateStrategy:
      type: Recreate    
    mariadb:
      enabled: false    
    externalDatabase:
      host: "matomo-mariadb"
      port: 3306
      user: "matomo"
      database: "matomo"
      existingSecret: "matomo-secrets"
      existingSecretPasswordKey: "db-password"    
    service:
      type: ClusterIP    
    ingress:
      enabled: false    
    persistence:
      enabled: true
      size: 2Gi
    cronjobs:
      archive:
        enabled: false
      taskScheduler:
        enabled: false 
    resources:
      requests:
        cpu: "250m"
        memory: "512Mi"
      limits:
        cpu: "500m"
        memory: "1Gi"