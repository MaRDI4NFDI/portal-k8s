{{- if .Values.fail2ban.enabled }}
apiVersion: traefik.io/v1alpha1
kind: Middleware
metadata:
  name: {{ .Release.Name }}-fail2ban
  namespace: {{ .Release.Namespace }}
spec:
  plugin:
    fail2ban:
      bantime: {{ .Values.fail2ban.bantime | quote }}
      findtime: {{ .Values.fail2ban.findtime | quote }}
      maxretry: {{ .Values.fail2ban.maxretry }}
      enabled: true
{{- end }}